{{!< default}}

<section class="gh-about gh-outer{{#match @custom.header_section_layout "!=" "Typographic profile"}}{{#unless @site.cover_image}} no-image{{/unless}}{{else}}{{#unless @site.icon}} no-image{{/unless}}{{/match}}">
    <div class="gh-about-inner gh-inner">
        {{#match @custom.header_section_layout "!=" "Typographic profile"}}
            {{#if @site.cover_image}}
                <img fetchpriority=high class="gh-about-image" src="{{@site.cover_image}}" alt="Image de fond d'arrière plan de {{@site.title}}">
            {{/if}}
        {{else}}
            {{#if @site.icon}}
                <img fetchpriority=high class="gh-about-image" src="{{@site.icon}}" alt="Logo de {{@site.title}}">
            {{/if}}
        {{/match}}
        <script>
(() => {
    if (!document.body.classList.contains('has-background-about')) return;

    const about = document.querySelector('.gh-about');
    if (!about) return;

    const image = about.querySelector('.gh-about-image');
    if (!image) return;

    const updateAboutHeight = () => {
        if (!image.naturalWidth || !image.naturalHeight) return;

        const width = about.clientWidth || image.clientWidth;
        if (!width) return;

        const height = width * image.naturalHeight / image.naturalWidth;
        about.style.setProperty('--about-height', `${height}px`);
        about.classList.add('initialized');
    };

    // Cas 1 : l’image est déjà chargée (fréquent avec fetchpriority=high)
    if (image.complete && image.naturalWidth) {
        updateAboutHeight();
    } else {
        // Cas 2 : on attend le chargement
        imagesLoaded(image, updateAboutHeight);
    }

    // Optionnel mais propre : recalcule si la fenêtre change (responsive)
    window.addEventListener('resize', () => {
        if (!image.naturalWidth) return; // sécurité
        updateAboutHeight();
    });
})();

        </script>
        <div class="gh-about-content">
            <div class="gh-about-content-inner">
                {{#if @custom.primary_header}}
                    <h1 class="gh-about-primary">{{{@custom.primary_header}}}</h1>
                {{/if}}
                {{#if @site.members_enabled}}
                    {{#unless @member}}
                        {{#if @custom.secondary_header}}
                        <p class="gh-about-secondary">{{{@custom.secondary_header}}}</p>
                        {{/if}}
                        <div class="gh-subscribe-input" data-portal>
                            jamie@example.com
                            <span class="gh-btn gh-primary-btn">Subscribe</span>
                        </div>
                    {{/unless}}
                {{/if}}
            </div>
        </div>
    </div>
</section>

<main class="gh-main gh-outer">

    {{!-- Contenu de la page /home --}}
    {{#get "pages" filter="slug:home" limit="1"}}
        {{#foreach pages}}
            <article class="gh-article">
                <header class="gh-article-header gh-canvas">
                    <h1 class="home">{{title}}</h1>
                </header>
                <section class="gh-content gh-canvas">
                    {{content}}
                </section>
            </article>
        {{/foreach}}
    {{/get}}
</main>

{{#contentFor "body_class"}}{{#match @custom.header_section_layout "Side by side"}} has-side-about{{/match}}{{#match @custom.header_section_layout "Large background"}}{{#if @site.cover_image}} is-head-transparent has-background-about{{else}} has-side-about{{/if}}{{/match}}{{#match @custom.header_section_layout "Typographic profile"}}{{#if @site.icon}} has-typographic-about{{else}} has-side-about{{/if}}{{/match}}{{/contentFor}}
